# Sensor to Matrix Position Mapping

## Where is the sensor-to-matrix array?

**There is NO explicit array!** The mapping is calculated on-the-fly using a simple formula.

## The Formula (in `mux_adc.c` line ~145-146):

```c
uint8_t matrix_row = (key_mapping->sensor - 1) / MATRIX_COLS;  // MATRIX_COLS = 12
uint8_t matrix_col = (key_mapping->sensor - 1) % MATRIX_COLS;
```

## Complete Sensor-to-Matrix Reference Table:

| Sensor # | Matrix Position | Your Keymap Key | Calculation                    |
|----------|-----------------|-----------------|--------------------------------|
| 1        | [0][0]          | ESC             | (1-1)/12=0, (1-1)%12=0        |
| 2        | [0][1]          | Q               | (2-1)/12=0, (2-1)%12=1        |
| 3        | [0][2]          | W               | (3-1)/12=0, (3-1)%12=2        |
| 4        | [0][3]          | E               | (4-1)/12=0, (4-1)%12=3        |
| 5        | [0][4]          | R               | (5-1)/12=0, (5-1)%12=4        |
| 6        | [0][5]          | T               | (6-1)/12=0, (6-1)%12=5        |
| 7        | [0][6]          | Y               | (7-1)/12=0, (7-1)%12=6        |
| 8        | [0][7]          | U               | (8-1)/12=0, (8-1)%12=7        |
| 9        | [0][8]          | I               | (9-1)/12=0, (9-1)%12=8        |
| 10       | [0][9]          | O               | (10-1)/12=0, (10-1)%12=9      |
| 11       | [0][10]         | P               | (11-1)/12=0, (11-1)%12=10     |
| 12       | [0][11]         | BSPC            | (12-1)/12=0, (12-1)%12=11     |
| 13       | [1][0]          | TAB             | (13-1)/12=1, (13-1)%12=0      |
| 14       | [1][1]          | A               | (14-1)/12=1, (14-1)%12=1      |
| 15       | [1][2]          | S               | (15-1)/12=1, (15-1)%12=2      |
| 16       | [1][3]          | D               | (16-1)/12=1, (16-1)%12=3      |
| 17       | [1][4]          | F               | (17-1)/12=1, (17-1)%12=4      |
| 18       | [1][5]          | G               | (18-1)/12=1, (18-1)%12=5      |
| 19       | [1][6]          | H               | (19-1)/12=1, (19-1)%12=6      |
| 20       | [1][7]          | J               | (20-1)/12=1, (20-1)%12=7      |
| 21       | [1][8]          | K               | (21-1)/12=1, (21-1)%12=8      |
| 22       | [1][9]          | L               | (22-1)/12=1, (22-1)%12=9      |
| 23       | [1][10]         | SCLN (;)        | (23-1)/12=1, (23-1)%12=10     |
| 24       | [1][11]         | ENT             | (24-1)/12=1, (24-1)%12=11     |
| 25       | [2][0]          | LSFT            | (25-1)/12=2, (25-1)%12=0      |
| 26       | [2][1]          | Z               | (26-1)/12=2, (26-1)%12=1      |
| 27       | [2][2]          | X               | (27-1)/12=2, (27-1)%12=2      |
| 28       | [2][3]          | C               | (28-1)/12=2, (28-1)%12=3      |
| 29       | [2][4]          | V               | (29-1)/12=2, (29-1)%12=4      |
| 30       | [2][5]          | B               | (30-1)/12=2, (30-1)%12=5      |
| 31       | [2][6]          | N               | (31-1)/12=2, (31-1)%12=6      |
| 32       | [2][7]          | M               | (32-1)/12=2, (32-1)%12=7      |
| 33       | [2][8]          | COMM (,)        | (33-1)/12=2, (33-1)%12=8      |
| 34       | [2][9]          | DOT (.)         | (34-1)/12=2, (34-1)%12=9      |
| 35       | [2][10]         | SLSH (/)        | (35-1)/12=2, (35-1)%12=10     |
| 36       | [2][11]         | RSFT            | (36-1)/12=2, (36-1)%12=11     |
| 37       | [3][0]          | LCTL            | (37-1)/12=3, (37-1)%12=0      |
| 38       | [3][1]          | LGUI (Win)      | (38-1)/12=3, (38-1)%12=1      |
| 39       | [3][2]          | LALT            | (39-1)/12=3, (39-1)%12=2      |
| 40       | [3][3]          | MO(1)           | (40-1)/12=3, (40-1)%12=3      |
| 41       | [3][4]          | SPC             | (41-1)/12=3, (41-1)%12=4      |
| 42       | [3][5]          | SPC             | (42-1)/12=3, (42-1)%12=5      |
| 43       | [3][6]          | SPC             | (43-1)/12=3, (43-1)%12=6      |
| 44       | [3][7]          | MO(2)           | (44-1)/12=3, (44-1)%12=7      |
| 45       | [3][8]          | RALT            | (45-1)/12=3, (45-1)%12=8      |
| 46       | [3][9]          | RGUI            | (46-1)/12=3, (46-1)%12=9      |
| 47       | [3][10]         | APP             | (47-1)/12=3, (47-1)%12=10     |
| 48       | [3][11]         | RCTL            | (48-1)/12=3, (48-1)%12=11     |

## How to Use This:

1. **Test a physical key** on your MUX board
2. **Note which key it types** (e.g., it types "ENTER")
3. **Find that key in the table above** (ENT is sensor 24, matrix [1][11])
4. **Update your mux_pins.c** to map that MUX channel to sensor 24

Example:
```c
// If MUX1 CH15 physically types "ENTER", then:
[15] = { .sensor = 24, .key = "Ent" },  // CH15 wired to sensor 24
```

## Quick Lookup by Key:

- **ESC**: sensor 1
- **Q**: sensor 2
- **TAB**: sensor 13
- **A**: sensor 14
- **ENTER**: sensor 24
- **LSHIFT**: sensor 25
- **Z**: sensor 26
- **SPACE**: sensors 41, 42, 43

The sensor number completely determines what key is pressed!
